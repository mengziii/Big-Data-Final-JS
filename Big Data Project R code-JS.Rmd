---
title: "CIND 820 Big Data Final Project"
author: "Jossa Soto"
date: "13/02/2022"
output: 
 html_document:
  keep_md: true
---

```{r setup, message=FALSE}
#loading needed libraries
library(tidyverse)
library(tidytext)
library(glue)
library(stringr)
library(ggplot2)
library(patchwork)
library(gt)
```

## Dataset
```{r}
twitter_data <- read.csv("Twitter US Airline Sentiment.csv", header = T, na.strings = c("","NA"))

#reduced sample size to start
set.seed(2421)
twitter_data <- twitter_data[sample(nrow(twitter_data), 5000),]

#declare each variable from df for easy use
tweet_id <- twitter_data$tweet_id
airline_sentiment <- twitter_data$airline_sentiment
airline_sentiment_confidence <- twitter_data$airline_sentiment_confidence
negativereason <- twitter_data$negativereason
negativereason_confidence <- twitter_data$negativereason_confidence
airline <- twitter_data$airline
airline_sentiment_gold <- twitter_data$airline_sentiment_gold
name <- twitter_data$name
negativereason_gold <- twitter_data$negativereason_gold
retweet_count <- twitter_data$retweet_count
tweet_text <- twitter_data$text
tweet_coord <- twitter_data$tweet_coord
tweet_created <- twitter_data$tweet_created
tweet_location <- twitter_data$tweet_location
user_TZ <- twitter_data$user_timezone

#display first 6 rows of data
head(twitter_data)
```

## Data Exploration

```{r}
str(twitter_data)

#change airline_sentiment to factors
twitter_data$airline_sentiment <- as.factor(twitter_data$airline_sentiment)
twitter_data$negativereason <- as.factor(twitter_data$negativereason)
twitter_data$negativereason_gold <- as.factor(twitter_data$negativereason_gold)

#change tweet_created from char to date
twitter_data$tweet_created <- as.Date(twitter_data$tweet_created)

#rerun str and summary to display updated variables
str(twitter_data)

#display summary
summary(twitter_data)

#standard deviation for numerical variables
sd(airline_sentiment_confidence); sd(!is.na(negativereason_confidence)); sd(retweet_count)
```

```{r}
#find the frequency of all possible values in negativereason_gold, airline_sentiment_gold, retweet_count, and tweet_coord

table(negativereason_gold)
table(airline_sentiment_gold)
table(retweet_count)
head(table(tweet_coord), 10)
```

```{r}
#check for and count any NAs
unlist(lapply(lapply(twitter_data, is.na), sum)) #unlist to convert the list output to a vector for easier readability
```

```{r warning = FALSE}
#Check for any outliers in the numerical variables

#airline sentiment confidence
ASC_box <- twitter_data %>% ggplot() + 
  geom_boxplot(aes(y = airline_sentiment_confidence), outlier.colour="black", outlier.shape=16, outlier.size=2, notch=FALSE) 

#negative reason confidence
NRC_box <- twitter_data %>% 
  ggplot() + 
  geom_boxplot(aes(y = negativereason_confidence), outlier.colour="black", outlier.shape=16, outlier.size=2, notch=FALSE) 

#retweet count
RC_box <- twitter_data %>% 
  ggplot() + 
  geom_boxplot(aes(y = retweet_count), outlier.colour="black", outlier.shape=16, outlier.size=2, notch=FALSE)

outlier_fig <- ASC_box + NRC_box + RC_box + plot_layout(ncol = 3)
outlier_fig
```